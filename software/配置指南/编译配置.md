# ç¼–è¯‘é…ç½®æŒ‡å—

## ğŸ¯ æ¦‚è¿°

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨é…ç½®STM32 500åŒLEDé¡¹ç›®çš„ç¼–è¯‘ç¯å¢ƒï¼ŒåŒ…æ‹¬ç¼–è¯‘å™¨è®¾ç½®ã€åº“æ–‡ä»¶é…ç½®ã€ç¼–è¯‘é€‰é¡¹ç­‰ã€‚

## ğŸ”§ ç¼–è¯‘å™¨é…ç½®

### 1. ç¼–è¯‘å™¨ç‰ˆæœ¬
- **ç¼–è¯‘å™¨ï¼š** ARM Compiler 5.05 update 1
- **ç‰ˆæœ¬è¦æ±‚ï¼š** 5.05+
- **è·¯å¾„ï¼š** C:\Keil_v5\ARM\ARMCC\Bin
- **ç‰¹ç‚¹ï¼š** æ”¯æŒC99æ ‡å‡†ï¼Œä¼˜åŒ–æ€§èƒ½å¥½

### 2. ç¼–è¯‘é€‰é¡¹
```
C/C++ â†’ Define:
- USE_HAL_DRIVER
- STM32F103xB

C/C++ â†’ Include Paths:
- Core/Inc
- Drivers/STM32F1xx_HAL_Driver/Inc
- Drivers/STM32F1xx_HAL_Driver/Inc/Legacy
- Drivers/CMSIS/Device/ST/STM32F1xx/Include
- Drivers/CMSIS/Include
```

### 3. ä¼˜åŒ–è®¾ç½®
```
C/C++ â†’ Optimization:
- Level: -O1 (å¹³è¡¡ä¼˜åŒ–)
- å…¶ä»–é€‰é¡¹: é»˜è®¤

Linker â†’ Scatter File:
- ä½¿ç”¨é»˜è®¤scatteræ–‡ä»¶
- è‡ªåŠ¨ç”Ÿæˆé“¾æ¥è„šæœ¬
```

## ğŸ“š åº“æ–‡ä»¶é…ç½®

### 1. HALåº“é…ç½®
```
åŒ…å«æ–‡ä»¶ï¼š
- stm32f1xx_hal.h
- stm32f1xx_hal_conf.h
- stm32f1xx_hal_msp.h

é…ç½®é€‰é¡¹ï¼š
- HALåº“ç‰ˆæœ¬ï¼š1.8.0+
- æ”¯æŒå¤–è®¾ï¼šSPI, GPIO, RCC
- è°ƒè¯•æ”¯æŒï¼šå¯ç”¨
```

### 2. CMSISåº“é…ç½®
```
åŒ…å«æ–‡ä»¶ï¼š
- core_cm3.h
- stm32f1xx.h
- system_stm32f1xx.h

é…ç½®é€‰é¡¹ï¼š
- å†…æ ¸ç‰ˆæœ¬ï¼šCortex-M3
- è®¾å¤‡ç³»åˆ—ï¼šSTM32F1xx
- ç³»ç»Ÿæ—¶é’Ÿï¼š72MHz
```

### 3. é¡¹ç›®åº“é…ç½®
```
åŒ…å«æ–‡ä»¶ï¼š
- hc595.h/c
- key.h/c
- segment_display.h/c
- spi_display.h/c
- menu_system.h/c

é…ç½®é€‰é¡¹ï¼š
- æ¨¡å—åŒ–è®¾è®¡
- æ¥å£æ¸…æ™°
- åŠŸèƒ½ç‹¬ç«‹
```

## âš™ï¸ ç¼–è¯‘è®¾ç½®

### 1. ç›®æ ‡é…ç½®
```
Target â†’ Device: STM32F103C8
Target â†’ Flash: 64KB
Target â†’ RAM: 20KB
Target â†’ Clock: 72MHz
```

### 2. è¾“å‡ºé…ç½®
```
Output â†’ Name of Executable: 500 double led
Output â†’ Create HEX File: å¯ç”¨
Output â†’ Create Browse Information: å¯ç”¨
Output â†’ Debug Information: å¯ç”¨
```

### 3. è°ƒè¯•é…ç½®
```
Debug â†’ Use: J-Link / J-Trace Cortex
Debug â†’ Settings â†’ Debug â†’ Port: SW
Debug â†’ Settings â†’ Flash Download â†’ Programming Algorithm: STM32F10x Med-density (64KB)
```

## ğŸ” ç¼–è¯‘éªŒè¯

### 1. ç¼–è¯‘æ£€æŸ¥
```
æ­¥éª¤ï¼š
1. æ‰“å¼€Keilé¡¹ç›®
2. æŒ‰F7ç¼–è¯‘
3. æ£€æŸ¥ç¼–è¯‘ç»“æœ
4. æŸ¥çœ‹ç¼–è¯‘ä¿¡æ¯

é¢„æœŸç»“æœï¼š
- 0 Error, 0 Warning
- ç¼–è¯‘æ—¶é—´ï¼š<30ç§’
- ç”Ÿæˆ.hexæ–‡ä»¶
- ä»£ç å¤§å°ï¼š<64KB
```

### 2. é“¾æ¥æ£€æŸ¥
```
æ­¥éª¤ï¼š
1. æ£€æŸ¥é“¾æ¥è„šæœ¬
2. éªŒè¯å†…å­˜æ˜ å°„
3. ç¡®è®¤ç¬¦å·è§£æ
4. æŸ¥çœ‹é“¾æ¥ä¿¡æ¯

é¢„æœŸç»“æœï¼š
- é“¾æ¥æˆåŠŸ
- å†…å­˜ä½¿ç”¨åˆç†
- ç¬¦å·è§£ææ­£ç¡®
- æ— é“¾æ¥é”™è¯¯
```

### 3. è¾“å‡ºæ£€æŸ¥
```
æ­¥éª¤ï¼š
1. æ£€æŸ¥.hexæ–‡ä»¶
2. éªŒè¯ä»£ç å¤§å°
3. ç¡®è®¤è°ƒè¯•ä¿¡æ¯
4. æŸ¥çœ‹ç¼–è¯‘æ—¥å¿—

é¢„æœŸç»“æœï¼š
- .hexæ–‡ä»¶ç”Ÿæˆ
- ä»£ç å¤§å°åˆç†
- è°ƒè¯•ä¿¡æ¯å®Œæ•´
- ç¼–è¯‘æ—¥å¿—æ¸…æ™°
```

## âš ï¸ å¸¸è§é—®é¢˜

### 1. ç¼–è¯‘é”™è¯¯
**é—®é¢˜ï¼š** ç¼–è¯‘å¤±è´¥ï¼Œå‡ºç°é”™è¯¯
**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥å¤´æ–‡ä»¶è·¯å¾„
- éªŒè¯åº“æ–‡ä»¶ç‰ˆæœ¬
- ç¡®è®¤ç¼–è¯‘å™¨è®¾ç½®
- æ¸…ç†å¹¶é‡æ–°ç¼–è¯‘

### 2. é“¾æ¥é”™è¯¯
**é—®é¢˜ï¼š** é“¾æ¥å¤±è´¥ï¼Œç¬¦å·æœªå®šä¹‰
**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥åº“æ–‡ä»¶åŒ…å«
- éªŒè¯å‡½æ•°å£°æ˜
- ç¡®è®¤é“¾æ¥è„šæœ¬
- æ£€æŸ¥ä¾èµ–å…³ç³»

### 3. ä¼˜åŒ–é—®é¢˜
**é—®é¢˜ï¼š** ä¼˜åŒ–åç¨‹åºå¼‚å¸¸
**è§£å†³æ–¹æ¡ˆï¼š**
- é™ä½ä¼˜åŒ–çº§åˆ«
- æ£€æŸ¥å…³é”®ä»£ç 
- ä½¿ç”¨volatileå…³é”®å­—
- ç¦ç”¨ç‰¹å®šä¼˜åŒ–

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### 1. ç¼–è¯‘æ€§èƒ½
```
ç¼–è¯‘æ—¶é—´ï¼š<30ç§’
ä»£ç å¤§å°ï¼š<64KB
RAMä½¿ç”¨ï¼š<20KB
Flashä½¿ç”¨ï¼š<64KB
```

### 2. è¿è¡Œæ€§èƒ½
```
ç³»ç»Ÿæ—¶é’Ÿï¼š72MHz
SPIé¢‘ç‡ï¼š8MHz
æ˜¾ç¤ºåˆ·æ–°ï¼š50Hz
æŒ‰é”®æ‰«æï¼š20Hz
```

### 3. ä¼˜åŒ–æ•ˆæœ
```
ä»£ç ä¼˜åŒ–ï¼š-O1
å¤§å°ä¼˜åŒ–ï¼šå¯ç”¨
é€Ÿåº¦ä¼˜åŒ–ï¼šå¹³è¡¡
è°ƒè¯•ä¿¡æ¯ï¼šå®Œæ•´
```

## ğŸ”§ é«˜çº§é…ç½®

### 1. è‡ªå®šä¹‰ç¼–è¯‘é€‰é¡¹
```
C/C++ â†’ Define:
- æ·»åŠ è‡ªå®šä¹‰å®å®šä¹‰
- é…ç½®åŠŸèƒ½å¼€å…³
- è®¾ç½®è°ƒè¯•é€‰é¡¹

C/C++ â†’ Include Paths:
- æ·»åŠ è‡ªå®šä¹‰è·¯å¾„
- é…ç½®åº“æ–‡ä»¶è·¯å¾„
- è®¾ç½®å¤´æ–‡ä»¶è·¯å¾„
```

### 2. æ¡ä»¶ç¼–è¯‘
```c
#ifdef DEBUG
    // è°ƒè¯•ä»£ç 
#endif

#ifdef USE_FEATURE_X
    // åŠŸèƒ½Xä»£ç 
#endif
```

### 3. ç¼–è¯‘è„šæœ¬
```batch
@echo off
echo å¼€å§‹ç¼–è¯‘...
cd /d "D:\stm32\BilibiliProject\500 double led\software\MDK-ARM"
"C:\Keil_v5\UV4\UV4.exe" -b "500 double led.uvprojx"
echo ç¼–è¯‘å®Œæˆï¼
pause
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

### é…ç½®æ–‡æ¡£
- [å¼€å‘ç¯å¢ƒé…ç½®.md](å¼€å‘ç¯å¢ƒé…ç½®.md)
- [è°ƒè¯•é…ç½®.md](è°ƒè¯•é…ç½®.md)
- [ç¡¬ä»¶è¿æ¥æŒ‡å—.md](ç¡¬ä»¶è¿æ¥æŒ‡å—.md)

### ä½¿ç”¨æ–‡æ¡£
- [ä½¿ç”¨è¯´æ˜](../ä½¿ç”¨è¯´æ˜/)
- [å·¥ç¨‹æ–‡ä»¶](../å·¥ç¨‹æ–‡ä»¶/)
- [æ•…éšœç»éªŒ](../æ•…éšœç»éªŒ/)

## ğŸ¯ ä¸‹ä¸€æ­¥

å®Œæˆç¼–è¯‘é…ç½®åï¼Œæ‚¨å¯ä»¥ï¼š

1. **å¼€å§‹è°ƒè¯•** - æŸ¥çœ‹ [è°ƒè¯•é…ç½®.md](è°ƒè¯•é…ç½®.md)
2. **äº†è§£é¡¹ç›®** - æŸ¥çœ‹ [å·¥ç¨‹æ–‡ä»¶](../å·¥ç¨‹æ–‡ä»¶/)
3. **è§£å†³é—®é¢˜** - æŸ¥çœ‹ [æ•…éšœç»éªŒ](../æ•…éšœç»éªŒ/)

---

**ç‰ˆæœ¬ï¼š** v1.0  
**æœ€åæ›´æ–°ï¼š** 2025-10-25  
**ç»´æŠ¤è€…ï¼š** STM32å¼€å‘å›¢é˜Ÿ
